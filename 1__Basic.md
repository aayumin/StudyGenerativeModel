# 🎨 생성모델(Generative Models) 기초 학습

---

## 📚 목차

1. 생성모델이란?
2. 확률 기초 개념 이해
3. 생성모델의 특징
4. 생성모델의 주요 종류  
     4-1) VAE(Variational Autoencoder)  
     4-2) GAN(Generative Adversarial Networks)  
     4-3) Diffusion Models  
5. 비교 정리

---

## 1. 생성모델이란?

### 생성모델 vs 판별모델

- 판별모델은 입력이 어떤 클래스에 속하는지를 분류하는 모델입니다.  
  예: "이 이미지는 고양이인가, 개인가?"

- 생성모델은 데이터 자체를 생성하는 모델입니다.  
  이미지를 그리거나, 텍스트를 생성하거나, 음악을 작곡하는 것도 가능합니다.

예: "고양이처럼 보이는 이미지를 만들어주세요."

🎲 비유: 실제 고양이 사진 1,000장을 본 후  
고양이의 특징을 학습하여,  
1,001번째 그럴듯한 새로운 고양이 사진을 만들어내는 것입니다.


---

## 2. 확률 기초 개념 이해

생성모델의 핵심은 "확률"입니다.  
가능한 데이터들 중에서 그럴듯한 데이터를 샘플링(sample) 하는 것이 생성의 본질입니다.

### 확률분포 (Probability Distribution)

- 데이터가 존재할 법한 공간 전체를 수학적으로 표현한 것입니다.
- 어떤 샘플이 나올 확률을 수치로 표현합니다.
- 예: p(x) → 특정 데이터 x가 나올 확률입니다.

```
AI에게 수천 장의 그림을 보여줬다고 가정해봅니다.  
고흐 스타일, 인상주의, 고양이 그림, 노을 사진, 흑백 초상화 등등…

이 AI는 다음과 같이 속으로 메모를 합니다:

- “고양이는 자주 등장하네?”
- “노란 배경에 고양이가 있는 조합이 흔하군”
- “노을과 산은 함께 나올 확률이 높아 보여”

이 과정을 통해 AI는, 어떤 조합이 자주 등장하는지에 대한 확률분포를 학습합니다.

🎯 이것이 바로 p(x) — 어떤 이미지 x가 나올 확률입니다.
```


### 샘플링(Sampling)

- 확률분포로부터 무작위로 하나의 샘플을 추출하는 과정입니다.
- 예: x ~ p(x) → x는 분포 p로부터 샘플링되었다는 의미입니다.

🎲 예시: 고양이 사진이 많을 때,  
학습된 분포로부터 새로운 고양이 이미지를 "뽑아내는" 것입니다.

```
이제 AI에게 “새로운 그림 하나 그려줘”라고 요청하면,  
AI는 배운 확률 분포를 참고하여 다음과 같이 판단합니다:

- “노란 배경과 고양이 조합은 40% 확률이야”
- “검정 고양이가 해바라기 들판에 있는 장면은 15% 확률이지”
- “새로운 조합도 만들어볼 수 있지, 비슷한 스타일로!”

그리고 이 중 하나를 무작위로 샘플링하여  
새로운 그림을 생성합니다.
```


**생성 모델의 목표**는  
→ 실제 데이터가 나올 법한 **분포를 학습**하는 것입니다.  
→ 학습이 완료되면, 이 분포를 바탕으로 **새로운 샘플을 생성**할 수 있습니다.

<img width="80%" height="80%" alt="image" src="https://github.com/user-attachments/assets/6f4f57c7-af74-4490-aa6e-a28dcf06cfc8" />


---

## 3. 생성모델의 특징

| 특징 | 설명 |
|------|------|
| 데이터 분포 학습 | 생성모델은 단순히 입력을 복사하거나 외우는 것이 아니라, 데이터가 어떻게 구성되어 있는지를 학습합니다. 즉, 관찰한 데이터를 통해 전체 데이터의 확률 분포를 추정하고, 그 분포를 기반으로 **보지 못한 새로운 데이터**를 만들어낼 수 있습니다. |
| 창의적이고 유연한 생성 | 입력에 따라 고정된 출력만 제공하는 것이 아니라, **다양한 형태와 조합**의 데이터를 만들어낼 수 있습니다. 예를 들어, 고양이 사진을 학습한 생성모델은 앉아 있는 고양이, 뛰는 고양이, 새로운 배경의 고양이 등 실제로 존재하지 않았던 이미지도 생성할 수 있습니다. |
| 확률 기반 샘플링 | 생성모델은 학습한 확률 분포로부터 **무작위 샘플링**을 수행하기 때문에, **같은 조건에서도 결과가 다양하게 나올 수 있는** 특징이 있습니다. 이는 예술 작품 생성, 대화 응답 생성, 음악 작곡 등 **다양성과 창의성이 중요한 작업**에 유리합니다. |



---

## 4. 생성모델의 주요 종류

### 확률 기반 모델

- 예: Naive Bayes, Gaussian Mixture Model (GMM)
- 수학적으로 데이터의 분포를 직접 계산하려고 합니다.

### Autoencoder 계열 (AE, VAE 등)

- 입력 데이터를 압축(인코딩)한 뒤, 다시 복원(디코딩)합니다.
- 이 과정을 통해 학습된 잠재 표현을 활용하여 새로운 데이터 생성이 가능합니다.

### GAN (생성과 판별을 동시에)

- Generator와 Discriminator가 서로 경쟁하는 구조입니다.
- 반복적 경쟁을 통해 더욱 그럴듯하고 정교한 결과물을 생성할 수 있습니다.

### 확산모델 (Diffusion)

- 이미지에 노이즈를 반복적으로 추가한 후,  
  반대로 노이즈를 제거하며 원래 이미지를 복원하는 방식입니다.


---

## 4-1. VAE (Variational Autoencoder)

입력 데이터를 압축하여 의미 있는 공간(latent space)에 표현한 후, 다시 복원하는 모델입니다.

- 일반 Autoencoder는 단순히 입력을 복사하듯 복원합니다.
- VAE는 확률 분포를 학습하여 더 다양한 결과를 생성할 수 있습니다.


<img width="70%" height="70%" alt="image" src="https://github.com/user-attachments/assets/af56ef16-dec8-4b01-b7b1-4a77445c3ec1" />

### 주요 구성 요소

1. Encoder: 입력 데이터를 잠재공간의 z 벡터로 압축 (→ 이때 각각의 값은 특정 숫자가 아니라, 평균과 분산의 2개 값을 이용하여 확률분포처럼 표현됨)
2. Sampling: 잠재 공간에서 (평균과 분산을 고려하여) 무작위로 z 벡터를 추출
3. Decoder: 랜덤으로 추출한 z 벡터를 바탕으로 이미지 복원

📦 비유: 다양한 사과를 하나의 "사과 공간"에 압축해놓고,  
이 공간에서 새로운 사과를 찍어내는 느낌입니다.



---

## 4-2. GAN (Generative Adversarial Networks)

적대적 학습(Adversarial Training)을 통해 고품질 데이터를 생성하는 모델입니다.


<img width="732" height="369" alt="image" src="https://github.com/user-attachments/assets/9ee0126c-5b47-4c88-bc4c-28ff4d7cabfd" />

### 주요 구성

- Generator (G): 가짜 데이터를 생성합니다.
- Discriminator (D): 입력이 진짜인지 가짜인지 구별합니다.

Generator는 Discriminator를 속이기 위해 점점 더 그럴듯한 정교한 데이터를 만들어냅니다.

```
🎭 비유: 위조지폐범과 형사의 게임  
위조지폐범(G)은 가짜 돈을 만들고,  
형사(D)는 그것이 진짜인지 가짜인지 판단합니다.  
이 싸움을 반복하면서 위조지폐범(G)은 점점 더 진짜 같은 돈을 만들어냅니다.
```

### 특징

- 고해상도 이미지 생성이 가능합니다.
- 단점:
  - 학습이 불안정합니다.
  - mode collapse(다양성 부족) 문제가 발생할 수 있습니다.


---

## 4-3. 확산모델 (Diffusion Models)

처음에는 랜덤한 노이즈에서 시작하여, 점차 이미지를 복원해가는 모델입니다.

<img width="60%" height="60%" alt="image" src="https://github.com/user-attachments/assets/f67719fd-73a0-463f-8e84-5fc2fbc7ea95" />

### 작동 원리

1. 원본 이미지에 점진적으로 노이즈를 추가합니다.
2. 최종적으로는 완전한 노이즈가 됩니다.
3. 학습된 모델이 이를 역방향으로 복원합니다.

🧊 비유: 얼려버린 퍼즐 그림을  
조금씩 녹여가며 원래 그림을 맞추는 느낌입니다.

### 장점

- 매우 고해상도이며 정교한 이미지 생성이 가능합니다.
- 학습에는 시간이 오래 걸리지만, 성능은 현재 최고 수준입니다.


---

## 5. 비교 정리

| 모델 | 구조 | 특징 | 단점 |
|------|------|------|------|
| VAE | 인코더-디코더 | 잠재공간 학습, 다양한 샘플 생성 | 이미지 품질이 낮은 편입니다. 약간 흐릿한 느낌의 이미지가 생성될 수 있습니다. |
| GAN | 생성자 vs 판별자 | 사실적인 이미지 생성 | 학습이 불안정하고, 다양성 부족 문제가 있습니다. |
| Diffusion | 순방향 노이즈 + 역방향 제거 | 매우 고품질 이미지 생성 | 학습이 오래 걸리고, 자원 소모가 큽니다. |

<img width="1200" height="545" alt="image" src="https://github.com/user-attachments/assets/9267d29f-4488-4931-a567-ad8f310ef937" />


